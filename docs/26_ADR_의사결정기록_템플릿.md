# ADR 의사결정 기록 템플릿 (Architecture Decision Record)
- 버전: 1.0
- 작성일: 2026-02-12
- 목적: 주요 의사결정을 문서화하여 향후 참조 및 변경 이력 추적
- 원칙: 모든 의사결정은 티켓 기반 (원칙 3), ADR은 L1 프로젝트 계층에 저장 (원칙 4)

---

## ADR 개요

### ADR이란?
- **Architecture Decision Record**: 아키텍처 및 중요 의사결정을 문서화한 기록
- 왜 그 결정을 내렸는지(근거), 어떤 대안이 있었는지, 무엇을 선택했는지 기록
- 미래의 에이전트/팀이 컨텍스트를 이해하고 변경 시 참조

### ADR이 필요한 경우
- 기술 스택 선택 (프레임워크, 라이브러리, 언어)
- 아키텍처 패턴 선택 (모놀리식 vs 마이크로서비스 등)
- 보안 정책 변경 (인증 방식, 암호화 방식)
- 크로스 BU 협업 규칙 변경
- 중요한 트레이드오프 결정 (성능 vs 유지보수성 등)

### ADR 저장 위치 (원칙 4: 기억 계층)
```
프로젝트/
├── docs/
│   └── adr/
│       ├── 0001-초기-기술스택-선택.md
│       ├── 0002-인증-방식-SSO-전환.md
│       └── 0003-데이터베이스-마이그레이션-전략.md
```

---

## ADR 템플릿

### 1) 기본 정보
- **ADR ID**: ADR-[연번] (예: ADR-0042)
- **제목**: [간결하고 명확한 제목]
- **상태**: 제안중(Proposed) / 승인됨(Accepted) / 폐기됨(Deprecated) / 대체됨(Superseded)
- **작성일**: YYYY-MM-DD
- **작성자**: [에이전트 ID 또는 팀명]
- **관련 티켓**: [티켓 ID] (원칙 3: 티켓 기반)

---

### 2) 컨텍스트 (Context)

#### 문제 상황
[무엇이 문제인가? 어떤 요구사항/제약사항이 있는가?]

예시:
```
현재 시스템은 세션 기반 인증을 사용 중이나, 엔터프라이즈 고객이 SSO 통합을 요구하고 있다.
기존 세션 방식은 다중 서버 환경에서 sticky session 필요하고, 모바일 앱에서 사용이 어렵다.
```

#### 영향 받는 이해관계자
- [BU/본부명]
- [고객/사용자 그룹]
- [관련 시스템/서비스]

#### 제약 조건
- 기술적 제약: [예: 레거시 시스템 호환성]
- 비용 제약: [예: 예산 한도 $X]
- 시간 제약: [예: 3개월 내 완료]
- 정책 제약: [예: 보안 정책 준수 필수]

---

### 3) 결정 사항 (Decision)

#### 선택한 해결책
[무엇을 하기로 결정했는가? 구체적으로 명시]

예시:
```
OAuth 2.0 + OpenID Connect (OIDC) 기반 SSO로 전환한다.
- 표준 프로토콜 사용으로 엔터프라이즈 IdP(Okta, Azure AD 등) 통합 용이
- JWT 토큰 기반으로 stateless 인증 가능
- 기존 세션 인증과 6개월간 병행 운영 후 단계적 전환
```

#### RACI (원칙 2: 실행-검토 분리)
| 역할 | 담당자 | 책임 |
|------|--------|------|
| Responsible (실행) | BU2 개발팀 | SSO 구현 |
| Accountable (승인) | CTO | 최종 승인 |
| Consulted (자문) | 보안본부, 엔터프라이즈 BU | 보안 검토, 고객 요구사항 |
| Informed (정보 공유) | 모든 BU | 변경 사항 통보 |

---

### 4) 근거 (Rationale)

#### 왜 이 결정을 내렸는가?
[선택한 이유를 설명. 데이터 기반으로 작성 권장]

예시:
```
1. 표준 준수: OIDC는 업계 표준이며, 대부분의 엔터프라이즈 IdP가 지원
2. 보안 강화: JWT 토큰 만료 시간 설정, refresh token으로 보안 향상
3. 확장성: stateless 인증으로 서버 스케일 아웃 용이
4. 고객 요구: 상위 10개 엔터프라이즈 고객 중 8개가 SSO 필수 요구
5. 비용 효율: 기존 Okta 계약 활용 가능 (추가 비용 최소)
```

#### 정량적 근거 (있는 경우)
| 지표 | 현재 | 목표 | 예상 개선 |
|------|------|------|----------|
| 로그인 성공률 | 92% | 98% | +6%p |
| 평균 로그인 시간 | 3.5초 | 2.0초 | -43% |
| 엔터프라이즈 전환율 | 60% | 90% | +30%p |

---

### 5) 대안 (Alternatives Considered)

#### 대안 1: [대안명]
- **설명**: [대안 개요]
- **장점**: [...]
- **단점**: [...]
- **왜 선택하지 않았나**: [근거]

예시:
```
대안 1: SAML 2.0 SSO
- 설명: SAML 프로토콜 기반 SSO
- 장점: 성숙한 표준, 많은 IdP 지원
- 단점: XML 기반으로 복잡, 모바일 앱 통합 어려움
- 왜 선택하지 않았나: 모바일 우선 전략과 맞지 않고, OIDC가 더 현대적
```

#### 대안 2: [대안명]
- **설명**: [대안 개요]
- **장점**: [...]
- **단점**: [...]
- **왜 선택하지 않았나**: [근거]

예시:
```
대안 2: 세션 기반 인증 유지 + Redis 세션 스토어
- 설명: 기존 세션 방식 유지, Redis로 공유 세션
- 장점: 최소 변경, 빠른 구현 가능
- 단점: SSO 미지원, 엔터프라이즈 요구사항 미충족
- 왜 선택하지 않았나: 핵심 문제(SSO 부재) 해결 안 됨
```

#### 대안 3: [대안명]
- **설명**: [...]
- **장점**: [...]
- **단점**: [...]
- **왜 선택하지 않았나**: [...]

---

### 6) 영향 (Consequences)

#### 긍정적 영향 ✅
- [구체적 이점 1]
- [구체적 이점 2]
- [구체적 이점 3]

예시:
```
✅ 엔터프라이즈 고객 전환율 30%p 향상 예상
✅ 보안 강화 (토큰 만료, refresh token)
✅ 서버 확장성 개선 (stateless)
✅ 모바일 앱 인증 지원 가능
```

#### 부정적 영향/트레이드오프 ⚠️
- [구체적 단점/리스크 1]
- [구체적 단점/리스크 2]
- [완화 방안]

예시:
```
⚠️ 구현 복잡도 증가 (OAuth/OIDC 학습 곡선)
   → 완화: 외부 Codex 에이전트로 아키텍처 리뷰
⚠️ 기존 시스템 마이그레이션 6개월 소요
   → 완화: 병행 운영 기간 설정, 단계적 전환
⚠️ JWT 토큰 크기로 인한 트래픽 증가 (~1KB/요청)
   → 완화: 토큰 클레임 최소화, 압축 적용
```

#### 영향 받는 컴포넌트/시스템
- [컴포넌트 1]: [어떻게 영향 받는가]
- [컴포넌트 2]: [어떻게 영향 받는가]

예시:
```
- API Gateway: JWT 검증 로직 추가
- 모바일 앱: OAuth 클라이언트 구현 필요
- 기존 웹앱: 세션 → JWT 전환 (6개월 병행)
- 운영 대시보드: 토큰 관리 UI 추가
```

---

### 7) 변경 이력 (History)

| 날짜 | 변경 사항 | 작성자 |
|------|----------|--------|
| 2026-02-12 | 초안 작성 (제안중) | architect-001 |
| 2026-02-15 | 보안본부 검토 반영 | architect-001 |
| 2026-02-18 | CTO 승인 (승인됨) | CTO |

---

### 8) 관련 ADR (있는 경우)

- **선행 ADR**: [ADR-0025: API Gateway 도입] - JWT 검증 위치 결정 시 참조
- **후속 ADR**: (향후 작성 시 링크)
- **대체된 ADR**: (이 ADR이 다른 결정을 대체하는 경우)

---

### 9) 체크리스트

#### ADR 작성 시
- [ ] 티켓 ID 연결 (원칙 3)
- [ ] 컨텍스트 명확히 기술 (왜 이 결정이 필요한가)
- [ ] 대안 2개 이상 검토 (선택하지 않은 이유 포함)
- [ ] RACI 정의 (원칙 2: 실행-검토 분리)
- [ ] 정량적 근거 포함 (가능한 경우)
- [ ] 부정적 영향 및 완화 방안 명시
- [ ] 관련자 검토 완료

#### ADR 승인 시
- [ ] 보안 영향 검토 (보안본부)
- [ ] 비용 영향 검토 (CFO)
- [ ] 크로스 BU 영향 확인 (해당 BU 리더)
- [ ] 최종 승인자 확인 (CTO/COO/CEO)
- [ ] 상태 "승인됨"으로 변경
- [ ] 관련자 전원 통보

#### ADR 폐기 시
- [ ] 폐기 사유 명시
- [ ] 대체 ADR 링크 (있는 경우)
- [ ] 상태 "폐기됨" 또는 "대체됨"으로 변경

---

## ADR 상태 전환 흐름

```
[제안중 (Proposed)]
    ↓
    검토 및 피드백 수렴
    ↓
[승인됨 (Accepted)] ──────→ [실행]
    ↓
    시간 경과 또는 새로운 결정
    ↓
[폐기됨 (Deprecated)] 또는 [대체됨 (Superseded)]
```

---

## ADR 활용 예시

### 예시 1: 기술 스택 선택

```markdown
# ADR-0001: 프론트엔드 프레임워크로 React 선택

## 기본 정보
- ADR ID: ADR-0001
- 상태: 승인됨
- 작성일: 2026-01-15
- 작성자: BU2 아키텍처팀
- 관련 티켓: TECH-001

## 컨텍스트
신규 고객 포털 개발을 위한 프론트엔드 프레임워크 선택 필요.
기존 레거시 시스템(jQuery)에서 현대적 SPA로 전환.

## 결정
React 18 + TypeScript를 표준 프론트엔드 스택으로 선택.

## 근거
1. 생태계 성숙도: 가장 큰 커뮤니티 및 라이브러리
2. 팀 역량: 기존 개발자 60%가 React 경험 보유
3. 채용 용이성: React 개발자 풀이 가장 큼
4. 성능: Virtual DOM 최적화 우수

## 대안
- Vue.js: 학습 곡선 낮으나, 생태계 작음
- Angular: 너무 무겁고 학습 곡선 높음
- Svelte: 성능 우수하나, 생태계 미성숙

## 영향
✅ 개발 속도 향상 (풍부한 라이브러리)
⚠️ 번들 크기 증가 → Vite 빌드 도구로 완화
```

### 예시 2: 아키텍처 패턴 선택

```markdown
# ADR-0015: 마이크로서비스 전환 연기, 모놀리식 유지

## 기본 정보
- ADR ID: ADR-0015
- 상태: 승인됨
- 작성일: 2026-02-10
- 작성자: CTO
- 관련 티켓: ARCH-042

## 컨텍스트
시스템 복잡도 증가로 마이크로서비스 전환 논의 있었으나,
현재 팀 규모(개발 10명)와 트래픽(10K DAU)을 고려.

## 결정
향후 1년간 모놀리식 유지, 단 모듈화(Modular Monolith) 강화.

## 근거
1. 팀 규모: 10명 팀에 마이크로서비스는 오버헤드
2. 트래픽: 현재 규모는 모놀리식으로 충분
3. 운영 복잡도: 분산 시스템 운영 경험 부족
4. 비용: 인프라 비용 3배 증가 예상

## 대안
- 즉시 마이크로서비스 전환: 운영 부담 과다
- 일부 서비스만 분리: 중간 단계의 복잡도만 증가

## 영향
✅ 운영 단순성 유지
✅ 개발 속도 유지 (분산 트랜잭션 불필요)
⚠️ 스케일링 제약 → 재검토 조건: 트래픽 10배 증가 시
```

---

## ADR 관리 정책

### 정기 리뷰
- 분기마다 승인된 ADR 리뷰 (여전히 유효한가?)
- 폐기 필요 시 새로운 ADR 작성 또는 상태 변경

### 검색 및 참조
- 새로운 결정 전 관련 ADR 검색 필수
- 유사 상황 발생 시 기존 ADR 참조하여 일관성 유지

### ADR 작성 의무
- L1 이상의 의사결정은 ADR 필수 (원칙 4)
- L2 본부급 의사결정은 ADR 필수
- L3 전사 정책 변경은 ADR 필수

---

## 승인

- 작성자:
- 검토자: (해당 분야 전문가)
- 승인자: (CTO/COO/CEO - 영향 범위에 따라)
- 승인 일자:
